<div class="row px-5">
    <div class="col-12">
        <div class="row">
            <div class="col-auto">
                <a href="@Url.Action("Listado", "Paciente")" class="btn btn-primary btn-sm">
                    <i class="fa-solid fa-arrow-left"></i> Regresar
                </a>
            </div>
        </div>
        <div class="row pt-3 pb-3">
            <div class="col-12">
                <div class="display-3" style="font-size: 2.5rem;">Paciente: Juan Pérez</div>
            </div>
        </div>

        <!-- Barra de tabs -->
        <div class="row mt-2">
            <div class="col-12">
                <ul class="nav nav-tabs nav-fill">
                    <li class="nav-item">
                        <a class="nav-link" href="@Url.Action("FichaClinica", "Paciente")">Ficha Clínica</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="@Url.Action("Tratamientos", "Paciente")">Tratamientos</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="@Url.Action("Archivos", "Paciente")">Archivos</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="@Url.Action("AsistenteIA", "Paciente")">Asistente IA</a>
                    </li>
                </ul>
            </div>
        </div>

        <!-- Botón flotante circular -->
        <button type="button" class="btn btn-primary btn-lg position-fixed bottom-0 end-0 m-4 rounded-circle z-3" data-bs-toggle="modal" data-bs-target="#treatmentModal">
            <i class="fa-solid fa-plus"></i> <!-- Ícono de agregar -->
        </button>

        <div class="mt-4">
            <!-- Botones que abren los modales -->
            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#improvementSummaryModal">Resumen de Mejoría</button>
            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#treatmentSummaryModal">Resumen de Tratamientos Hechos</button>
        </div>




        <!-- Tratamientos ya existentes -->
        <div class="card mt-4 shadow-sm">
            <div class="card-header d-flex justify-content-between py-3 bg-primary text-white">
                <h5 class="align-content-center">Tratamiento del 24-12-2024</h5>
                <div>
                    <button type="button" class="btn btn-light text-primary btn-sm me-2" data-bs-toggle="modal" data-bs-target="#editarModal">
                        <i class="fa-solid fa-pen"></i> Editar
                    </button>
                    <a href="#" class="btn btn-outline-light btn-sm me-2" data-bs-toggle="modal" data-bs-target="#EliminacionModal">
                        <i class="fa-solid fa-trash"></i> Eliminar
                    </a>
                    <button type="button" class="btn btn-light text-primary btn-sm me-2" data-bs-toggle="modal" data-bs-target="#opinionIaModal">
                        <i class="fa-solid fa-robot"></i> Opinión IA
                    </button>
                </div>
            </div>
            <div class="card-body">
                <!-- Diagnóstico -->
                <div class="mb-3">
                    <strong class="text-secondary">Diagnóstico:</strong>
                    <div class="mt-3">
                        <p class="card-text ps-3 border-start border-2 border-primary lh-base">
                            El paciente presenta dolor lumbar moderado con irradiación hacia la pierna derecha, acompañado de limitación en la flexión del tronco y leve inflamación en la región paravertebral. Se observa tensión muscular en la zona afectada y reporta molestias al permanecer sentado por largos periodos.
                        </p>
                    </div>
                </div>
                <hr />
                <!-- Evaluación Realizada -->
                <div class="mb-3">
                    <strong class="text-secondary">Evaluación Realizada:</strong>
                    <div class="mt-3">
                        <p class="card-text ps-3 border-start border-2 border-primary">
                            Evaluación completa de movilidad y análisis postural. No se observaron alteraciones severas.
                        </p>
                    </div>
                </div>
                <hr />
                <!-- Tratamiento Realizado -->
                <div class="mb-3">
                    <strong class="text-secondary">Tratamiento Realizado:</strong>
                    <div class="mt-3">
                        <p class="card-text ps-3 border-start border-2 border-primary">
                            Terapia manual y ejercicios de fortalecimiento de la región lumbar.
                        </p>
                    </div>
                </div>
                <hr />
                <!-- Archivos Anexados -->
                <div>
                    <strong class="text-secondary">Archivos Anexados:</strong>
                    <div class="rounded p-3 border border-1 border-secondary">
                        <div class="row">
                            <!-- Example Image -->
                            <a href="https://medlineplus.gov/images/Xray_share.jpg"
                               data-fancybox="attached-files"
                               class="col-md-1">
                                <img src="https://medlineplus.gov/images/Xray_share.jpg"
                                     class="card-hover rounded"
                                     style="height: 100px; width: 100px; object-fit: cover"
                                     alt="Alternate Text" />
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div class="card-footer text-muted py-3">
                <div class="d-flex justify-content-end flex-wrap">
                    <div class="ms-4">
                        <strong>Monto Cobrado:</strong> $1000
                    </div>
                    <div class="ms-4">
                        <strong>Tipo de Pago:</strong> Tarjeta de Crédito
                    </div>
                    <div class="ms-4">
                        <strong>Solicita Factura:</strong> Sí
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal para agregar tratamiento -->
<div class="modal fade" id="treatmentModal" data-bs-backdrop="static" tabindex="-1" aria-labelledby="treatmentModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-primary">
                <h5 class="modal-title text-white" id="treatmentModalLabel">Nuevo Tratamiento</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
            </div>
            <div class="modal-body">
                <!-- Formulario para crear un tratamiento -->
                <form>
                    <!-- Diagnóstico -->
                    <div class="mb-3">
                        <label for="diagnostic" class="text-muted h6">Diagnóstico:</label>
                        <textarea class="form-control" id="diagnostic" rows="3" placeholder="¿Qué síntomas comenta el paciente?"></textarea>
                    </div>
                    <!-- Evaluación Realizada -->
                    <div class="mb-3">
                        <label for="evaluation" class="text-muted h6">Evaluación Realizada:</label>
                        <textarea class="form-control" id="evaluation" rows="3" placeholder="¿Qué se realizó para diagnosticar los problemas?"></textarea>
                    </div>
                    <!-- Tratamiento Realizado -->
                    <div class="mb-3">
                        <label for="treatment" class="text-muted h6">Tratamiento Realizado:</label>
                        <textarea class="form-control" id="treatment" rows="3" placeholder="¿Qué tratamientos se le realizaron en la sesión?"></textarea>
                    </div>
                    <!-- Monto Cobrado -->
                    <div class="mb-3">
                        <label for="amountCharged" class="text-muted h6">Monto Cobrado:</label>
                        <input type="number" class="form-control" id="amountCharged" placeholder="Ingrese el monto">
                    </div>
                    <!-- Tipo de Pago -->
                    <div class="mb-3">
                        <label for="paymentType" class="text-muted h6">Tipo de Pago:</label>
                        <select class="form-select" id="paymentType">
                            <option selected disabled>Seleccione una opción</option>
                            <option value="Tarjeta de Crédito">Tarjeta de Crédito</option>
                            <option value="Tarjeta de Débito">Tarjeta de Débito</option>
                            <option value="Efectivo">Efectivo</option>
                            <option value="Sinpe Móvil">Sinpe Móvil</option>
                            <option value="Transferencia Bancaria">Transferencia Bancaria</option>
                        </select>
                    </div>
                    <!-- Solicita Factura -->
                    <div class="mb-3">
                        <label for="invoiceRequest" class="text-muted h6">Solicita Factura:</label>
                        <select class="form-select" id="invoiceRequest">
                            <option value="Sí">Sí</option>
                            <option value="No">No</option>
                        </select>
                    </div>
                    <!-- Archivos Anexados -->
                    <div>
                        <label for="attachedFiles" class="text-muted h6">Archivos Anexados:</label>
                        <input type="file" class="form-control" id="attachedFiles" multiple />
                        <div class="mt-2">
                            <!-- Previsualización de miniaturas de archivos -->
                            <div class="row" id="filePreviews">
                                <!-- Los elementos de previsualización se agregarán dinámicamente con JavaScript -->
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cerrar</button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Archivar tratamiento</button>
                <button type="submit" class="btn btn-primary">Guardar Tratamiento</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal para editar tratamiento -->
<div class="modal fade" id="editarModal" data-bs-backdrop="static" tabindex="-1" aria-labelledby="treatmentModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-primary">
                <h5 class="modal-title text-white" id="treatmentModalLabel">Editar Tratamiento</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
            </div>
            <div class="modal-body">
                <!-- Formulario para editar un tratamiento -->
                <form>
                    <!-- Diagnóstico -->
                    <div class="mb-3">
                        <label for="diagnostic" class="text-muted h6">Diagnóstico:</label>
                        <textarea class="form-control" id="diagnostic" rows="3" placeholder="Descripción breve del diagnóstico actual">El paciente presenta dolor lumbar moderado con irradiación hacia la pierna derecha, acompañado de limitación en la flexión del tronco y leve inflamación en la región paravertebral. Se observa tensión muscular en la zona afectada y reporta molestias al permanecer sentado por largos periodos.</textarea>
                    </div>
                    <!-- Evaluación Realizada -->
                    <div class="mb-3">
                        <label for="evaluation" class="text-muted h6">Evaluación Realizada:</label>
                        <textarea class="form-control" id="evaluation" rows="3" placeholder="Descripción de la evaluación realizada">Evaluación completa de movilidad y análisis postural. No se observaron alteraciones severas.</textarea>
                    </div>
                    <!-- Tratamiento Realizado -->
                    <div class="mb-3">
                        <label for="treatment" class="text-muted h6">Tratamiento Realizado:</label>
                        <textarea class="form-control" id="treatment" rows="3" placeholder="Descripción del tratamiento aplicado">Terapia manual y ejercicios de fortalecimiento de la región lumbar.</textarea>
                    </div>
                    <!-- Monto Cobrado -->
                    <div class="mb-3">
                        <label for="editAmountCharged" class="text-muted h6">Monto Cobrado:</label>
                        <input type="number" class="form-control" id="editAmountCharged" placeholder="$1000">
                    </div>
                    <!-- Tipo de Pago -->
                    <div class="mb-3">
                        <label for="editPaymentType" class="text-muted h6">Tipo de Pago:</label>
                        <select class="form-select" id="editPaymentType">
                            <option selected>Tarjeta de Crédito</option>
                            <option value="Tarjeta de Débito">Tarjeta de Débito</option>
                            <option value="Efectivo">Efectivo</option>
                            <option value="Sinpe Móvil">Sinpe Móvil</option>
                            <option value="Transferencia Bancaria">Transferencia Bancaria</option>
                        </select>
                    </div>
                    <!-- Archivos Anexados -->
                    <div>
                        <label for="attachedFiles" class="text-muted h6">Archivos Anexados:</label>
                        <input type="file" class="form-control" id="attachedFiles" multiple />
                        <div class="mt-2">
                            <!-- Previsualización de miniaturas de archivos -->
                            <div class="row" id="filePreviews">
                                <a href="https://medlineplus.gov/images/Xray_share.jpg"
                                   data-fancybox="attached-files"
                                   class="col-md-1">
                                    <img src="https://medlineplus.gov/images/Xray_share.jpg"
                                         class="card-hover rounded"
                                         style="height: 100px; width: 100px; object-fit: cover"
                                         alt="Rayos X" />
                                </a>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cerrar</button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Archivar tratamiento</button>
                <button type="submit" class="btn btn-primary">Guardar Cambios</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal para opinión IA-->
<div class="modal fade" id="opinionIaModal" tabindex="-1" aria-labelledby="opinionIaModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="opinionIaModalLabel">Opinión de la IA</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p><strong>Opinión:</strong> Según los datos analizados, el tratamiento aplicado es adecuado para los síntomas presentados y debería mejorar significativamente la movilidad del paciente.</p>
                <p>Se sugiere realizar un seguimiento semanal para ajustar la terapia según la evolución del paciente.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal para Resumen de Mejoría -->
<div class="modal fade" id="improvementSummaryModal" tabindex="-1" aria-labelledby="improvementSummaryModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="improvementSummaryModalLabel">Resumen de Mejoría</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p><strong>Progreso del Paciente:</strong> Según las evaluaciones realizadas, el paciente ha mostrado una mejora notable en la movilidad y una reducción significativa del dolor.</p>
                <p>Se recomienda continuar con el tratamiento actual y realizar sesiones de evaluación periódica para ajustar según sea necesario.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal para Resumen de Tratamientos Hechos -->
<div class="modal fade" id="treatmentSummaryModal" tabindex="-1" aria-labelledby="treatmentSummaryModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="treatmentSummaryModalLabel">Resumen de Tratamientos Hechos</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p><strong>Tratamientos realizados:</strong></p>
                <ul>
                    <li>Terapia manual y ejercicios de fortalecimiento de la región lumbar.</li>
                    <li>Masajes terapéuticos para reducir tensión muscular.</li>
                    <li>Ejercicios guiados para mejorar postura y flexibilidad.</li>
                </ul>
                <p>En total, se han realizado <strong>6 sesiones</strong> con buenos resultados.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Eliminación -->
<div class="modal fade" id="EliminacionModal" data-bs-backdrop="static" tabindex="-1" aria-labelledby="confirmarEliminacionModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-primary">
                <h5 class="modal-title text-white" id="confirmarEliminacionModalLabel">Confirmar Eliminación</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
            </div>
            <div class="modal-body">
                <p>¿Está seguro de que desea realizar esta acción? Ingrese su contraseña para confirmar.</p>
                <div class="mb-3">
                    <label for="password" class="form-label">Contraseña:</label>
                    <input type="password" class="form-control" id="password" placeholder="Ingrese su contraseña" required>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Cerrar</button>
                <button type="button" class="btn btn-danger" id="confirmarEliminarBtn">Confirmar</button>
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
        $("#tablaTratamientos").DataTable({
            language: {
                url: '//cdn.datatables.net/plug-ins/2.1.8/i18n/es-ES.json',
            },
            responsive: true,
            columnDefs: [
                {
                    targets: [8],
                    orderable: false,
                    className: 'text-center'
                }
            ]
        });
        $("#tablaArchivos").DataTable({
            language: {
                url: '//cdn.datatables.net/plug-ins/2.1.8/i18n/es-ES.json',
            },
            responsive: true,
            order: [[2, 'desc']],
            columnDefs: [
                {
                    targets: [5],
                    className: 'text-center',
                    orderable: false
                }
            ]
        });
    });

    $(document).ready(function () {
        $('[data-fancybox="attached-files"]').fancybox({
            buttons: ["zoom", "close"], // Add desired buttons (zoom, close, etc.)
            loop: true,                // Allow looping through the gallery
            animationEffect: "zoom",   // Choose an animation effect
        });
    });
</script>
<link rel="stylesheet" href="~/Recursos/css/EstilosPersonal.css">

